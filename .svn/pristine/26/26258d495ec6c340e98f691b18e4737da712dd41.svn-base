<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<c:set var="contextPath" value="${pageContext.request.contextPath }" />
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>个人中心</title>
<jsp:include page="../../common/css.jsp"></jsp:include>
<link rel="stylesheet"
	href="${contextPath }/static/ace/assets/css/bootstrap-editable.css" />
</head>
<body>
	<div class="main-container">
		<div class="row">
			<div class="col-xs-12">
				<h3 class="header smaller lighter blue">个人中心</h3>
				<div class="col-xs-12 col-sm-9">
					<h4 class="blue">
						<span class="middle">${SESSION_USER.unitName }</span> <span
							class="label label-success arrowed-in-right"> <i
							class="ace-icon fa fa-circle smaller-80 align-middle"></i> 可用
						</span>
					</h4>

					<div class="profile-user-info">
						<div class="profile-info-row">
							<div class="profile-info-name">用户名</div>

							<div class="profile-info-value">
								<span id="username">${SESSION_USER.username }</span>
							</div>
						</div>

						<div class="profile-info-row">
							<div class="profile-info-name">密码</div>

							<div class="profile-info-value">
								<i class="fa fa-key light-orange bigger-110"></i> <span
									class="editable editable-click" id="password">${SESSION_USER.password }</span>
							</div>
						</div>

						<div class="profile-info-row">
							<div class="profile-info-name">联系人</div>

							<div class="profile-info-value">
							<i class="fa fa-user light-orange bigger-110" ></i>
								<span id="contact">${SESSION_USER.contact }
								
								</span>
							</div>
						</div>

						<div class="profile-info-row">
							<div class="profile-info-name">手机</div>

							<div class="profile-info-value">
								<i class="fa fa-phone light-orange bigger-110"></i>
								<span id="phone">${SESSION_USER.phoneNumber }</span>
							</div>
						</div>

						<div class="profile-info-row">
							<div class="profile-info-name">单位地址</div>

							<div class="profile-info-value">
								<i class="fa fa-map-marker light-orange bigger-110"></i>
								<span id="address">${SESSION_USER.unitAddr }</span>
							</div>
						</div>
						

						<div class="row">
							<button class="btn btn-white btn-info btn-bold"  onclick="save();">
								<i class="ace-icon fa fa-floppy-o bigger-120 blue"></i> 保存
							</button>
						</div>
					</div>


				</div>

			</div>

		</div>

	</div>
	<jsp:include page="../../common/js.jsp"></jsp:include>
	<!-- 可编辑插件js -->
	<script
		src="${contextPath }/static/ace/assets/js/x-editable/bootstrap-editable.js"></script>
	<script
		src="${contextPath }/static/ace/assets/js/x-editable/ace-editable.js"></script>
	<!-- 基础js -->
	<script src="${contextPath }/static/ace/assets/js/ace/ace.js"></script>
	<!-- 引用对应的js -->
	<script type="text/javascript"> 
		//editables on first profile page
		$.fn.editable.defaults.mode = 'inline';
		$.fn.editableform.loading = "<div class='editableform-loading'><i class='ace-icon fa fa-spinner fa-spin fa-2x light-blue'></i></div>";
	    $.fn.editableform.buttons = '<button type="submit" class="btn btn-info editable-submit"><i class="ace-icon fa fa-check"></i></button>'+
	                                '<button type="button" class="btn editable-cancel"><i class="ace-icon fa fa-times"></i></button>'; 
		
	    $('#password').editable({ 
			type: 'password',
			name: 'password'
	    });
	    
	    $('#contact').editable({ 
			type: 'text',
			name: 'contact'
	    });
	    
	    $('#phone').editable({ 
			type: 'text',
			name: 'phone'
	    });
	    
	    $('#address').editable({ 
			type: 'text',
			name: 'address'
	    });
	    
	    //保存
	    function save(){
	    	var data = {};
	    	data.id=${SESSION_USER.id};
	    	data.phoneNumber=$('#phone').text().replace(/[\s|空]/g,'');
	    	data.password=$('#password').text().replace(/[\s|空]/g,'');
	    	data.contact=$('#contact').text().replace(/[\s|空]/g,'');
	    	data.unitAddr=$('#address').text().replace(/[\s|空]/g,'');
	    	$.post(contextPath+"/user/edit",data,function(res){
	    		if(res.success){
	    			alert('信息修改成功');
	    			for ( var key in data) {
	    				$('#'+key).text(data[key]);
					}
	    		}else{
	    			alert('网络异常,请联系管理员!');
	    		}
	    	},'json');
	    }
	</script>

</body>
</html>